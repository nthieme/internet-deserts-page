<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Internet Deserts</title>
	<meta name="description" content="A story about places where the internet hasn't changed">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
		/* default / demo page */
		* {
			box-sizing: border-box;
		}
		html,
		body {
			margin: 0;
			padding: 0;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
			background-color: #303030;
		}
		body {
			min-height: 1280px;
			font-weight: 300;
		}
		p,
		h1,
		h2,
		h3,
		h4,
		a {
			margin: 0;
			font-weight: 300;
			color: white;
		}
		a,
		a:visited,
		a:hover {
			color: #ff7d84;
			text-decoration: none;
			border-bottom: 1px solid currentColor;
		}
		#intro {
			max-width: 40rem;
			margin: 1rem auto;
		}
		.intro__overline {
			font-size: 1.4rem;
		}
		.intro__hed {
			font-size: 1.4rem;
			margin: 1.5rem auto;
			text-transform: uppercase;
			font-weight: 900;
			letter-spacing: 0.05em;
			text-align: center;
		}
		.intro__dek {
			font-size: 1.4rem;
			text-align: center;
		}
		/* demo */
		#intro {
			margin-bottom: 100px;
		}
		#outro {
			height: 640px;
			margin: 0px 200px 0px 200px
		}
		/* scrollama */
		#scroll {
			position: relative;
		}
		.scroll__graphic {
			position: -webkit-sticky;
			position: sticky;
			float: right;
			top: 0;
			right: 2rem;
			-webkit-transform: translate3d(0, 0, 0);
			-moz-transform: translate3d(0, 0, 0);
			transform: translate3d(0, 0, 0);
		}
		.scroll__graphic p {
			text-align: center;
			padding: 1rem;
			position: absolute;
			top: 50%;
			left: 50%;
			-moz-transform: translate(-50%, -50%);
			-webkit-transform: translate(-50%, -50%);
			transform: translate(-50%, -50%);
			font-size: 8rem;
			font-weight: 900;
			color: #666;
		}
		.scroll__text {
			position: relative;
			padding: 0 1rem;
			max-width: 30rem;
			width: 33%;
		}
		.step {
			margin: 0 auto 2rem auto;
			border: 0px solid #fff;
		}
		.step:last-child {
			border-bottom: 0px solid #fff;
		}
		.step p {
			text-align: center;
			padding: 1rem;
			font-size: 1.5rem;
		}

		.scrollama__debug-offset p {
			color: #fff;
		}

		.visual-wrap {
    		align-items: flex-start;
		}
		.visual-wrap {
		    position: absolute;
		    top: 0;
		    left: 0;
		    right: 0;
		    bottom: 0;
		    display: flex;
		    align-items: center;
		    justify-content: center;
		    text-align: center;
		    width: 900px;
		    height: 482.4px;
		}

/* This will style any <img> element in .parent div */
		.visual-wrap .img1 {
		   height: 100%;
		   width: 100%;
		}

		.legend {
			position: absolute; 
			bottom: 0; 
			left: 0;
			width: 550px;
		    height: 50px;
		}
		.legend-circ {
			position: absolute; 
			bottom: 0; 
			left: 0;
			width: 160px;
		    height: 50px;
		}
		.legend-des {
			position: absolute; 
			bottom: 0; 
			left: 0;
			width: 400x;
		    height: 70px;
		}

		.button{
		    background-color: Transparent;
		    background-repeat:no-repeat;
		    border: none;
		    cursor:pointer;
		    overflow: hidden;
		    outline:none;
    		text-decoration: wavy underline;
    		text-decoration-color: #ff7d84;
    		text-align: center;
			font-size: 1.5rem;
			text-align: center;
			font-weight: 300;
			color: white;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
			width: auto;
   			margin: 0px; 
   			padding-bottom: 2px;
   			padding-top: 0px;
   			padding-right: 0px;
   			padding-left: 0px; 

		}

		.tippy-tooltip.light-theme {
			  color: #26323d;
			  background-color: #303030;

			  .tippy-backdrop {
			    background-color: #303030;
			  }
			    border-radius: 25px;
    			border: 2px solid #808080;
    			width: 400px;


			  .tippy-roundarrow {
			    fill: white;
			  }

		}
		iframe{
			width: 1px;min-width: 100%;
			border:none; 
		}

	</style>
 	<script src='https://d3js.org/d3.v4.min.js'></script>
 	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/stickyfill/2.1.0/stickyfill.js'></script>
	<script src='https://unpkg.com/intersection-observer@0.5.0/intersection-observer.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/scrollama/1.4.3/scrollama.min.js'></script>
	<script src="https://unpkg.com/tippy.js@3/dist/tippy.all.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.6.1/iframeResizer.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/iframe-resizer/3.6.1/iframeResizer.contentWindow.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/mobile-detect/1.4.3/mobile-detect.min.js"></script>

	<link rel="stylesheet" type="text/css" href="https://unpkg.com/tippy.js/dist/tippy.css">


</head>

<body>
	<section id='intro'>
		<div id = 'mobile_sub'>
		</div>

		<h1 class='intro__hed'>Internet deserts</h1>
		<p class='intro__dek'>
			Nick Thieme
		</p>
	</br>
		<p>
		Not so long ago, I watched my partner of 10 years grow anxious then angry as the Free Application for Federal Student Aid (FAFSA) website frustrated her attempts to file for the student loans she needs to pay for classes. After an hour of this, she took a break and I asked if there was any other way to file FAFSA forms. After all, I'd only ever seen them online. She was as stumped as me.</p>
	</br>
		<p>For good or bad, online gateways are our sole practicable points of entry to student loans, job markets, higher education, and to culture. Sure, in some cases you can print a resume and mail it accross the country to a hiring manager or go to the library to read the right books, magazines, and newspapers, but you're disadvantaged by living on a time delay if you do, and the cases where that's possible are fewer each year.</p>
	</br>
		<p>With the average websites' file size growing because of video and more complicated code, are internet speeds increasing fast enough to keep up?</p>
	</section>
	<section id='scroll'>
		<div class='scroll__graphic sticky'>
			
			<div class="visual-wrap">
				<img src="states.png" class="img1", id='states', style="opacity: 1;"> 
				<img src="legend.png" class="legend", id='legend', style="opacity: 0;"> 
			</div>

			<div class="visual-wrap">
				<img src="0.png" class="img1", id='im0', style="opacity: 0;"> 
			</div>

			<div class="visual-wrap">
				<img src="1.png" class="img1", id='im1', style="opacity: 0;"> 
			</div>

			<div class="visual-wrap">
				<img src="2.png" class="img1", id='im2', style="opacity: 0;"> 
			</div>

			<div class="visual-wrap">
				<img src="3.png" class="img1", id='im3', style="opacity: 0;"> 
			</div>

			<div class="visual-wrap">
				<img src="4.png" class="img1", id='im4', style="opacity: 0;"> 
				<img src="des_leg.png" class="legend-des", id='legend-des', style="opacity: 0;"> 
			</div>

			<div class="visual-wrap">
				<img src="5.png" class="img1", id='im5', style="opacity: 0;"> 
				<img src="leg_circ.png" class="legend-circ", id='legend-circ', style="opacity: 0;">
			</div>

			<div class="visual-wrap">
				<img src="6.png" class="img1", id='im6', style="opacity: 0; width: 1000px"> 
			</div>

			<div class="visual-wrap">
				<img src="7.png" class="img1", id='im7', style="opacity: 0; width: 600px;"> 
			</div>
		</div>
		<div class='scroll__text'>
			<div class='step' data-step='0'>
				<div id ="reveal0", style="opacity: 0;">
					<p>This is the average speed of the internet in US census tracts during 2009.</p>
					<p>The data we're using here, the M-Lab dataset, started that year, so there's a lot of empty space.</p>
					<p>But most of the areas that aren't empty are dark black, meaning people in those census areas had internet speeds below5 megabytes per second (Mbps).</p>
					<p>Netflix was still mailing out DVD's in that dark time, long ago, but for reference, 5 Mbps is their <a href="https://help.netflix.com/en/node/306">minimum recomendation from streaming HD video.</a>
				</div>
			</div>
			<div class='step' data-step='1'>
				<div id = "reveal1", style="opacity: 0;">
					<p>2012 is more of the same.</p>
					<p>The Mountains area, the Midwest, and rural Maine are all as slow as ever.</p>
					<p> And in a pattern that repeats over the next couple time chunks, the cooridor from Washington, D.C. to New York City has the fastest internet in the country.</p>
				</div>
			</div>

			<div class='step' data-step='2'>
				<div id = "reveal2", style="opacity: 0;">
					<p>Here's the internet speed in 2015.</p> 
					<p>While North Dakota is mainly known for Fargo and the Great Plains, outside the D.C.-NYC corridor, it also has some of the fastest internet speeds in the country.</p>
					<p>Though in this case, that's still not that fast&#8211;between 5 and 20 Mbps.</p>
				</div>
			</div>
			<div class='step' data-step='3'>
				<div id = "reveal3", style="opacity: 0;">
					<p>2018 finally brings good news to people who live outside the East Coast and North Dakota.</p>
					<p>Where black was the dominant color from 2009 to 2015, strokes of deep purple and light violet now cover the country.</p>
					<p>That year, for the first time, the plurality of census tracts had average internet speeds in the 5-10 and 10-20 Mbps ranges.</p>
					<p>That's reflected in the average internet speed across the U.S. It increased from 4.6 in 2010 to 5.2 in 2012, to 7.9 in 2015, and finally to 10.5 in 2018.</p>
					<p>For a lot of people, then, the internet is getting better at the tremendous improvement rate  of technology.</p>
				</div>
			</div>
			<div class='step' data-step='4'>
				<div id = "reveal4", style="opacity: 0;">
					<p>But this happy tale of better internet isn't told in every home. There are lots of places where things are just the same as ever. </p>
					<p>Areas like these&#8211;their internet speeds ignored by the march of technological progress seen from ocean to ocean&#8211;are what we call <em>internet deserts</em>.</p>
					<p>These are the tracts with the same slow internet today that they had in 2010. Only North Dakota and Delaware are desert-free.</p>
				</div>
			</div>
			<div class='step' data-step='5'>
				<div id = "reveal5", style="opacity: 0;">
					<p>Another kind of internet desert is especially damaging.</p>
					<p>More like <a href="http://americannutritionassociation.org/newsletter/usda-defines-food-deserts">food deserts</a> and <a href="https://www.chronicle.com/interactives/education-deserts">education deserts</a>, these internet deserts are areas of the country where the internet is slow for everyone around.</p> 
					<p>Every orange dot on the map to the right is an area that matched two dismal conditions in 2018. First, their average internet speed was slower than 1.5 Mbps. Second, four of their five closest neighboring areas also had average internet speeds slower than 1.5 Mbps. The pink and purple dots are areas matching the same conditions but for high <button class="button" title="I'm a tooltip!">latency</button>, instead of slow internet speed.</p>
					
					<!--This gets removed and injected into the tooltip-->
					<div id= myTemplate>
						<p>What's latency?</p>
						<br/>
						<p> When you talk to a friend on the internet, your message has to physically leave your computer, travel through the pipes of the internet, and find its way into your friend's computer. The latency is the amount of time it takes your message to get from your computer to your friend's computer.</p>
						<br/>
						<p>High latency is bad. Using the internet when you have high latency is like having a conversation with a very drunk person while sober. There's a longer lag time than usual between  you saying something and them responding.</p>
						<br/>
						<p>Average latency measures congestion, either in a home network or the broader internet. If a network isn't setup right, it'll be slow when it's being used many ways at once. These are the purple dots. In those places, family members ask each other to stop using Netflix so they can Skype a coworker. They can get responsive internet, sometimes, maybe, when everthing is just so.</p>
						<br/>
						<p>Minimum latency measures the ideal experience a service provider can give a user. If minimum latency is high, truly live interaction on the internet is impossible, and no struggling on the user's part can change that.</p>
					</div>

				</div>
			</div>
			<div class='step' data-step='6'>
				<div id = "reveal6", style="opacity: 0;">
					<p>Deserts don't spring up overnight at random. That's as true for the Gobi desert as it is for the food deserts experienced by Latino and Black residents of South Los Angeles. What do internet deserts have in common?</p>
					<p>Looking at the demographics of census tracts that contain internet deserts is simulataneously enlightening and misleading. Compared with census tracts not containing deserts, desert tracts are 15% whiter, 3x less black, and roughly equivalent in income.</p>
					<p>But in this case, race is an effect, not a cause. In reality, deserts are much more likely to show up in rural tracts than they are urban ones, by a factor of about 4. Since rural areas are also much whiter, tracts containing deserts are whiter as well.</p>
				</div>
			</div>
			<div class='step' data-step='7'>
				<div id = "reveal7", style="opacity: 0;">
					<p>In fact, of the five states with the highest percentage of internet desert tracts, four have white population percentages above the national average of 72% with two states having white populations of 90% or above.</p>
				</div>
			</div>
			<div class='step step1' data-step='8'>
			</div>
		</div>
	</section>
	<section id='outro'>
	</br>
	<div>
		<p>This stark difference in internet access and internet quality is usually called the "digital divide," and it's<a href = "https://en.wikipedia.org/wiki/Digital_divide_in_the_United_States"> well-documented.</a> In the U.S., rural residents and urban residents are often on different sides of the divide, and internet deserts are just another ruler we can use to measure the distance between them.</p>
	</br>
		<p>Changing the internet speed and latency thresholds for an internet desert gives a different picture of what parts of the country qualify. Move the sliders around to see which parts of the country are below different thresholds.</p>
	</div>
		<iframe id="myIframe" src="https://furriertransform.shinyapps.io/deserts_plotter/" scrolling="no"></iframe>
	<div>
		<h2>This is just the introduction to a larger set of stories on the state of the internet in the U.S. <a href = "https://opentechinstitute.github.io/SOTI/SOTI.html">Follow here to keep reading!</a></h2>
	</div>
</br>
<div>
		<p>The dataset used for this analysis, the M-Lab NDT test, is a free test that makes its data publically-available for researchers, journalists, and anyone interested to take a look and analyze. The more tests that get taken, the better the data, and more we can learn about the internet in this country and around the world. If you'd like to contribute, the test can be found <a href= "https://speed.measurementlab.net/#/">at this link</a>, and the data can be <a href ="https://www.measurementlab.net/data/">by following the instructions here</a>.</p>	
	</br>
		<p>This article is written in D3 using the <a href='https://github.com/russellgoldenberg/scrollama'>scrollama.js library</a> developed by Russell Goldenberg at The Pudding.</p>
	</br>
		<p>Code for this article can be found at <a href="https://github.com/nthieme/nthieme.github.io">my GitHub account</a></p>
	<br/>
		<p>A huge thanks to Georgia Bullen for guiding this article from conception to completion and helping to create and strengthen the ideas in it at every step. Another big thank you to Peter Boothe for explaining the difference between minimum RTT and average RTT, and coming up with examples to illustrate their difference.</p>


	</div>
	</section>
	<script>
		var detector = new MobileDetect(window.navigator.userAgent);
		console.log( "Mobile: " + detector.mobile());
		if(detector.mobile()===null){
			//do nothing
		}else{
			d3.select('#mobile_sub').append("p").text("It seems like you're using a mobile device. Flip your phone sideways and pinch zoom out for best results.");
			var metaTag=document.createElement('meta');
			metaTag.name = "viewport"
			metaTag.content = "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"
			document.getElementsByTagName('head')[0].appendChild(metaTag);
		}
		// using d3 for convenience
		var container = d3.select('#scroll');
		var graphic = container.select('.scroll__graphic');
		var text = container.select('.scroll__text');
		var step = text.selectAll('.step');
		var step1 = text.selectAll('.step1');
		// initialize the scrollama
		var scroller = scrollama();
		// generic window resize listener event
		function handleResize() {
			// 1. update height of step elements
			var stepHeight = Math.floor(window.innerHeight * 1.2);
			//step.style('height', stepHeight + 'px');
			step1.style('height', 0 + 'px');
			// 2. update width/height of graphic element
			var bodyWidth = d3.select('body').node().offsetWidth;
			var graphicMargin = 16 * 4;
			var textWidth = text.node().offsetWidth;
			var graphicWidth = container.node().offsetWidth - textWidth - graphicMargin;
			var graphicHeight = Math.floor(window.innerHeight / 2);
			var graphicMarginTop = Math.floor(graphicHeight / 2);
			graphic
				.style('width', graphicWidth + 'px')
				.style('height', graphicHeight + 'px')
				.style('top', graphicMarginTop + 'px');
			// 3. tell scrollama to update new element dimensions
			scroller.resize();
		}
		// scrollama event handlers
		function handleStepEnter(response) {
			// response = { element, direction, index }
			// add color to current step only
			step.classed('is-active', function (d, i) {
				return i === response.index;
			})
			// update graphic based on step
			fade_out_time = 700
			fade_in_time = 500

			new_plot_name="#im"+String(response.index);

			if(response.index==0){
				graphic.select("#legend").transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity",1);
			}else if(response.index==3){
					graphic.select("#legend").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity",1);
					graphic.select("#legend-des").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity",0);
			}else if(response.index==4){
					graphic.select("#legend-des").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity",1);
			}else if(response.index==5){
				graphic.select("#legend-circ").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity", 1);
				graphic.select("#legend-des").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity",0);
			}else if(response.index==6){
				graphic.select("#states").transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity",0); 
			}

			if (response.index==8){
				graphic.select(new_plot_name).transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity", 0);
				text.select("#reveal7").transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity", 0);	
			}
			if(response.index>=4){
				graphic.select("#legend").transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity",0);
			}
			if (response.index<6){
				graphic.select("#states").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity",1);
				graphic.select("#im4").transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity", 0);
			}
			if (response.index!=5){
				graphic.select("#legend-circ").transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity", 0);
			}

			graphic.selectAll("img:not(#states):not(#legend):not(#legend-circ):not(#legend-des)").transition().duration(fade_out_time).ease(d3.easeLinear).style("opacity", 0);	
			text.selectAll(String("#reveal")+String(response.index)).transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity", 1);			

			setTimeout(function(){graphic.select(new_plot_name).transition().duration(fade_in_time).ease(d3.easeLinear).style("opacity", 1); }, fade_in_time);
		}
		function handleContainerEnter(response) {
			// response = { direction }
		}
		function handleContainerExit(response) {
			// response = { direction }
		}
		function setupStickyfill() {
			d3.selectAll('.sticky').each(function () {
				Stickyfill.add(this);
			});
		}
		function init() {
			setupStickyfill();
			// 1. force a resize on load to ensure proper dimensions are sent to scrollama
			handleResize();
			// 2. setup the scroller passing options
			// this will also initialize trigger observations
			// 3. bind scrollama event handlers (this can be chained like below)
			scroller.setup({
				container: '#scroll',
				graphic: '.scroll__graphic',
				text: '.scroll__text',
				step: '.scroll__text .step',
				debug: false,
				offset: 0.35,
			})
				.onStepEnter(handleStepEnter)
				.onContainerEnter(handleContainerEnter)
				.onContainerExit(handleContainerExit);
			// setup resize event
			window.addEventListener('resize', handleResize);
		}
		// kick things off
		init();
	
	</script>

    <script src="https://unpkg.com/popper.js/dist/umd/popper.min.js"></script>
    <script src="https://unpkg.com/tippy.js/dist/tippy.standalone.min.js"></script>

    <!-- Initialize tooltips by calling the `tippy` function with a CSS selector -->
    <script>
    tippy('button', {
      content: document.querySelector('#myTemplate'),
	  theme: 'light',
	  placement: 'top-start',
	  distance: 0,
	  arrow: true,
	  arrowType: 'sharp',
	  arrowTransform: 'scale(0.7)' //skinny arrow
	});
	</script>
	<script>iFrameResize({log:true}, '#myIframe')</script>

</body>

</html>